┌─────────────────────────────────────────────────────────────────┐
│                      ORCHESTRATION LAYER                         │
│                    (Prefect / Airflow)                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │  Scheduler   │→ │ Task Queue   │→ │  Monitoring  │           │
│  └──────────────┘  └──────────────┘  └──────────────┘           │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                      EXTRACTION LAYER                            │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐     │
│  │  Alpha    │  │ Finnhub   │  │   FRED    │  │  Weather  │     │
│  │  Vantage  │  │    API    │  │    API    │  │    API    │     │
│  └─────┬─────┘  └─────┬─────┘  └─────┬─────┘  └─────┬─────┘     │
│        │              │              │              │           │
│        └──────────────┴──────────────┴──────────────┘           │
│                          ↓                                      │
│            ┌─────────────────────────────┐                      │
│            │   Rate Limiter & Retry      │                      │
│            │   Raw Data Staging (S3)     │                      │
│            └─────────────────────────────┘                      │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    TRANSFORMATION LAYER                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐         │
│  │  Clean   │→ │Standardize│→ │ Feature  │→ │ Validate │        │
│  │          │  │           │  │Engineer  │  │          │        │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘         │
│                     ↓                                           │
│            ┌─────────────────────────────┐                      │
│            │ Processed Data Cache        │                      │
│            └─────────────────────────────┘                      │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                       LOADING LAYER                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │  PostgreSQL  │  │  S3 Storage  │  │  Data Lake   │           │
│  │  (Analytics) │  │  (Archive)   │  │  (Optional)  │           │
│  └──────────────┘  └──────────────┘  └──────────────┘           │
│          ↓                                                      │
│  ┌──────────────────────────────────────┐                       │
│  │  Materialized Views & Indexes        │                       │
│  └──────────────────────────────────────┘                       │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    CONSUMPTION LAYER                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│  │Analytics │  │   ML     │  │Dashboard │  │   API    │       │
│  │ Queries  │  │ Training │  │  Tools   │  │ Serving  │       │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘       │
└─────────────────────────────────────────────────────────────────┘